<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:p="http://primefaces.org/ui"
xmlns:subject="http://java.sun.com/jsf/composite/subject"
xmlns:ui="http://java.sun.com/jsf/facelets">
   
<h:body>
  
  <f:metadata>
      	
      	<f:viewParam name="selectMode" value="#{pageModel.selectMode}" /> 		
  	</f:metadata>

  <ui:composition template="masterlayout.xhtml" >
  
  <ui:define name="content">
      <h2 style="text-align: center"><h:outputText value="#{message.subjects_headline}" /></h2>
	  <h:panelGrid id="page" columns="1" styleClass="positionCentered">
		  <h:form>
			   <subject:subject id="subjectDialog"  commercialSubject="#{commercialSubject}" message="#{message}"   saveAction="#{subjectController.save()}"  />  
			   <h:panelGrid id="search" columns="5" styleClass="centered">
			      <p:outputLabel for="subjectPager" value="#{message.subjects_page_prefix}[1...#{subjectsModel.paging.maxPages}]" />
			      <p:spinner id="subjectPager"   min="1" max="#{subjectsModel.paging.maxPages}" size="#{subjectsModel.paging.maxPages}"  value="#{subjectsModel.paging.currentPage}"/> 
			      <p:outputLabel for="namePattern" value="#{message.subjects_search_label}" />
			      <p:inputText id="namePattern"  value="#{subjectsModel.pattern}"  >
			 	     <p:ajax event="change" update="@this"  process="@this"/>
			      </p:inputText>
                  <p:commandButton id="paging" value="suchen"  action="#{subjectController.subjects()}"   update="@form" process="@parent"  />     
               </h:panelGrid>        
			
			   <p:dataTable  id="subjects" var="subjectVar" paginator="false" rows="#{subjectsModel.paging.pageSize}"   value="#{subjectsModel.commercialSubjects}"  selection="#{subjectsModel.selected}"  >  
			   	   <p:column selectionMode="single" style="width:2%" />  
                   <p:column headerText="#{message.subjects_table_column_name}">#{subjectVar.name}</p:column> 
                   <p:column headerText="#{message.subjects_table_column_description}">#{subjectVar.description}</p:column>  
                   <p:ajax event="rowSelectRadio"  update="@form" process="@this"/> 
			   </p:dataTable>
	
			   <h:panelGrid id="buttonPanel" columns="3"  rendered="#{!pageModel.selectMode}">
			      <p:commandButton value="#{message.subject_add_button}" oncomplete="subjectDlg.show();"    process="@form"  update="@form"/>
			        <p:commandButton  value="#{message.subjects_document_button}"   action="#{documentController.assignFromSubject()}"  rendered="#{not empty subjectsModel.selected}"   update="@form"  process="@this,subjects"  /> 
			      <p:commandButton  value="#{message.subject_change_button}" update="@form" oncomplete="subjectDlg.show();" process="@this,subjects"  actionListener="#{subjectController.openChangeDialog()}"  rendered="#{not empty subjectsModel.selected}" />
			      <p:commandButton value="#{message.subject_delete_button}"   action="#{subjectController.delete()}"  process="@this,subjects" update="@form" rendered="#{not empty subjectsModel.selected}" />	
			   </h:panelGrid>
			   
			    <h:panelGrid id="buttonPanelSection" columns="2"  rendered="#{pageModel.selectMode}">
			    		  <p:commandButton value="#{message.subject_ok_button}" action="#{opportunityController.addSubject()}"    process="@this"  update="@parent" rendered="#{not empty subjectsModel.selected}"/>
			    		  <p:button value="#{message.subject_cancel_button}" outcome="opportunity.xhtml"    />
			    </h:panelGrid>
		
			</h:form>
		</h:panelGrid>
		   
   </ui:define>
    	
   </ui:composition>
</h:body>
</html>


