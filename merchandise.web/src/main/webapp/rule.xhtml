<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:p="http://primefaces.org/ui"
xmlns:u="http://example.com/functions"
xmlns:ui="http://java.sun.com/jsf/facelets">
   
    <h:body>
    
    
     <ui:composition template="masterlayout.xhtml">
         <ui:define name="content">
           <h2 style="text-align: center">
					<h:outputText value="#{message.rule_headline}" />
			</h2>
			
			 <h:form>
 
	 
			 <p:panelGrid columns="1" styleClass="positionCentered">
			    <p:messages errorClass="error" globalOnly="true" />  
			 <p:panelGrid  columns="3" columnClasses="labelColumnStyle,inputColumnStyle,messageColumnStyle" >
		 
		  
		  		<p:outputLabel id="idLabel" for="id" value="#{message.rule_id}" />  
		  		 <p:inputText id="id" label="id"  value="#{rule.id}" styleClass="gridInputField"  readonly="true" />
		  		<p:message id="idMessage" for="id" display="text" />
		  
		  		<p:outputLabel id="nameLabel" for="name" value="#{message.rule_name}" />  
                <p:inputText id="name" label="name"  value="#{rule.name}" styleClass="gridInputField" />
             	<p:message id="nameMessage" for="name" display="text" />
                
                <p:outputLabel id="stateLabel" for="state" value="#{message.rule_state}" />  
                    	
                <p:selectBooleanButton id="state" value="#{rule.state}" onLabel="#{message.rule_state_active}" offLabel="#{message.rule_state_deactive}" disabled="#{(empty rule.rule.documents()) and (!rule.state) }" onIcon="ui-icon-check" offIcon="ui-icon-close" >
                <p:ajax update="stateMessage,state" listener="#{ruleController.changeState()}"/>  
                </p:selectBooleanButton>  
            	
            	
            	<p:message id="stateMessage" for="state" display="text" />
            	
            	
            	
            	<p:outputLabel id="sourceLabel" for="source" value="#{message.rule_source}" rendered="#{not empty rule.rule.documents()}" />  
            	
            	<h:commandLink id="source" value="#{u:list(rule.rule.documents().keySet())[0]}"  rendered="#{not empty rule.rule.documents()}" >
            		
            	    <p:fileDownload value="#{documentController.stream()}" />  
            	</h:commandLink>
            	
            	<p:message id="sourceMessage" for="source" display="text" rendered="#{not empty rule.rule.documents()}" />
            	
        		
              	<p:outputLabel id="fileuploadLabel" for="source" value="#{message.rule_upload}"  />  
              	 <p:fileUpload update="@form"  id="fileupload" label="#{message.document_upload_button}"    fileUploadListener="#{documentController.removeAllAndAddNew}"  dragDropSupport="false"  
                   sizeLimit="2000000"  allowTypes="/(\.|\/)(groovy)$/" invalidSizeMessage="#{message.document_invalid_size_message}"     invalidFileMessage="#{message.document_wrong_file_message}"  auto="true"   >  
			 
		 
		 		</p:fileUpload>
              	
              <p:message id="fileuploadMessage" for="fileupload" display="text"  />
               </p:panelGrid>
			
			  
			    
			    <f:facet name="footer">
			    <p:button value="#{message.rule_cancel_button}" outcome="/rules.xhtml" >
			       <f:param  name="state"  value="#{rule.parentState}" disable="#{empty  rule.parentState}" />
			    </p:button>
			    <p:commandButton value="#{message.rule_save_button}" action="#{ruleController.save()}"  rendered="#{not empty rule.id}">
			     	<f:param  name="state"  value="#{rule.parentState}" disable="#{empty  rule.parentState}" />
			    </p:commandButton>
			    
			   
			    
			    </f:facet>
			    
			</p:panelGrid>
			
			
			
			</h:form>
			
			
         </ui:define>
     
     </ui:composition>
  
   	</h:body>
</html>


