{
   "language": "javascript",
   "views": {
	   "pricePerUnit": {"map": "function(doc) {
               if( doc.unit && doc.quality && doc.pricePerUnit && doc.min  ) {
                  key = {'quality' : doc.quality, 'unit' : doc.unit }; 
                  values={'min' : doc.min , 'max' : doc.max, 'pricePerUnit': doc.pricePerUnit };
                  emit(key, values );
               } 
           }"
       }
   },   
   "lists" : {
   	    "quantityFilter": "function(head, req) { 
   	        send('{ \"rows\":[\\n') ; 
   	          while(row=getRow()) { 
   	             qual = req.query.quantity ; 
   	             min=row.value.min;
   	             max=row.value.max; 
   	             if (! min) { 
   	                  min=0;
   	             };  
   	             if( qual  &&  qual >=  min  &&  ((qual  <= max) || ! max) ) {  
   	                 send(JSON.stringify(row));
   	             } 
   	          } 
   	          send('\\n]}') ;  
   	    }"
   }    
}